# Прогноз повторной госпитализации и длительности лечения диабетиков

**Аналитическая инициатива на основе открытых медицинских данных**

### Описание проекта
Инициатива по этому исследованию была начата мной в рамках изучения влияния клинических факторов на ключевые показатели эффективности стационарного лечения пациентов с диабетом.

Целью проекта было не только построение прогностической модели повторной госпитализации, но и расширенный регрессионный анализ факторов, влияющих на длительность пребывания в больнице, что выходит за рамки стандартной постановки задачи и подчёркивает исследовательский характер работы.

### Цели исследования
**Классификация**

Построить модель, предсказывающую вероятность повторной госпитализации в течение 30 дней (признак readmitted).

**Регрессия**

Проанализировать влияние медицинских факторов на длительность госпитализации (time_in_hospital) и построить соответствующую регрессионную модель.

Используемые библиотеки
```
- pandas, numpy, matplotlib, seaborn,
- scikit-learn, xgboost, lightgbm, catboost,
- phik — для расширенного корреляционного анализа категориальных переменных.
```

### Классификация: повторная госпитализация

Для задачи классификации было протестировано несколько моделей:
```
- Logistic Regression (с L1 и L2 регуляризацией)
- Random Forest
- XGBoost
- LightGBM
- CatBoost
```
Основная метрика: ROC AUC, а также recall, precision по классу 1

| Модель              | Accuracy | Recall (класс 1) | Precision (класс 1) | F1 (класс 1) | Weighted F1 | ROC AUC    |
| ------------------- | -------- | ---------------- | ------------------- | ------------ | ----------- | ---------- |
| Logistic Regression | 0.67     | 0.59             | 0.08                | 0.15         | 0.76        | 0.6728     |
| Random Forest       | 0.95     | 0.00             | 0.00                | 0.00         | 0.93        | 0.6640     |
| XGBoost             | 0.79     | 0.41             | 0.10                | 0.16         | 0.84        | 0.6631     |
| LightGBM            | 0.72     | 0.54             | 0.09                | 0.16         | 0.80        | **0.6889** |
| CatBoost            | 0.76     | 0.45             | 0.09                | 0.16         | 0.83        | 0.6486     |

**Вывод**

Модель LightGBM показала лучшую способность распознавать повторные госпитализации (recall = 0.54) при сбалансированном AUC-ROC (0.6889). Именно её я выбрала для дальнейшего гиперпараметрического тюнинга.

**Ключевые факторы, влияющие на длительность лечения**

- Анализ коэффициентов Ridge-регрессии показал, что:
- Важную роль играют диагнозы, особенно diag_1_V57 и diag_1_414;
- Количество назначенных медикаментов (num_medications) существенно влияет на длительность;
- Также значимы показатели, связанные с приёмом препаратов, таких как pioglitazone и nateglinide.

Эти выводы логично соотносятся с клинической практикой — чем сложнее случай, тем дольше длится лечение.

### Регрессия: длительность лечения

Решение задачи регрессии было инициировано мной для глубокой оценки факторов, влияющих на длительность пребывания пациента в больнице.

Были протестированы модели:
```
- Linear Regression
- Ridge Regression (с оптимальным параметром α = 10)
- Lasso Regression
```

| Модель | MAE      | RMSE     |
| ------ | -------- | -------- |
| Linear | 1.75     | 2.32     |
| Ridge  | **1.75** | **2.32** |
| Lasso  | 2.20     | 2.81     |

Наиболее значимые переменные по результатам анализа коэффициентов Ridge-модели:
```
- diag_1_V57, diag_1_414 — тип основного диагноза
- num_medications — количество назначенных медикаментов
- Приём специфических препаратов (pioglitazone, nateglinide)
```
Эти признаки логично отражают клиническую тяжесть состояния пациента и оправданно коррелируют с длительностью лечения.



P.S. Проведённый анализ может использоваться как основа для построения систем поддержки принятия врачебных решений и медицинской аналитики в больничной системе.
